{% extends 'journal/base_user.html' %}
{% load staticfiles %}

{% block 'title' %}
<title>Journal </title>
{% endblock %}

{% block 'page-css' %}
<link rel="stylesheet" type="text/css" href="{% static 'journal/activities/css/style.css' %}">
{% endblock %}

{% block 'page-js' %}
<script src="{% static 'journal/activities/js/main.js' %}"></script>
{% if is_student %}
<script>
setInterval(function() {
	$.get('/ping', function(data) {
		$('.badge').html(data);
	});
}, 3600);
setInterval(function() {
	$.get("/feed", function(data) {
		$('.notifications').html(data);
	});
}, 3550);
</script>
{% endif %}
{% endblock %}

{% block 'controller' %}
ng-controller="activityTutorialCtrl"
{% endblock %}

{% block 'nav-content' %}
<h3> {% if user and not user.is_anonymous %}
	Welcome <br> <a href="/profile">{{ user.get_full_name|default:user.username }}</a>! <br>
	<a href="{% url 'auth:logout' %}?next={{ request.path }}"> <h5>Logout</h5> </a>
	{% else %}
	<a href="#">Login with Google</a>
	{% endif %}
</h3>
{% if is_student %}
<h4> Click on the add button <br>
	to create a new journal. <br>
	To edit a journal,<br>
	click on an activity.
</h4> <br>
{% endif %}
<h5> Need Inspiration? </h5>

{% if is_student %}
	<div class="dropdown">
  		<button class="btn btn-default dropdown-toggle" type="button"
			id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true"
			aria-expanded="true" ng-click="bounce()">
    	Notifications
    		<span class="badge">{% include 'journal/unread_count.html' %}</span>
  		</button>


  		<ul class="dropdown-menu">
  		<div class="notifications">
  			{% include 'journal/feed.html'%}
  		</div>
  		</ul>
	</div>

	<div>
		<button class="btn btn-default tutorial" ng-click="triggerStepCount()" type="button">Tutorial</button>
	</div>
{% else %}
<div class="coordinator-link">
	<a href="/{{ back_link }}"><i class="fa fa-long-arrow-left fa-6x"></i> Back to the students page. </a>
</div>
{% endif %}

{% endblock %}

{% block 'main-content'%}
<div class="content">
	<div class="activities-list">
		<div class = "row">
			<div class="col-xs-12 col-md-12 col-lg-12">
				<div class="pencil-sign" >
					<img src = "{% static 'journal/activities/img/journal_sign.png' %}">
				</div>
			</div>
			{% if is_student %}
			<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4 tutorial-add" >
				<div class="add-journal-sign">
					<a href="/activity_details/">
						<img src = "{% static 'journal/activities/img/add_sign.png' %}">
					</a>
				</div>
			</div>
			{% endif %}

			<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4" ng-repeat="activity in activities track by $index">
				<div class="activity-box">
					<div class="activity-name" ng-bind="activity"></div>
				</div>
			</div>

			<!-- {% if activities %}
				{% for activity in activities %}
				<div class="col-xs-12 col-sm-12 col-md-6 col-lg-4" >
					<a href="/entries/{{ activity.pk }}">
						<div class="activity-box">
							<div class="activity-name">
								{{ activity.name_short }}
							</div>
							<div class="activity-description">
								{{activity.description_short}}
							</div>
						</div>
					</a>
				</div>
				{% endfor %}
		{% endif %} -->

	<!-- All tutorial dialogs here -->
	<div class="overlay" ng-if="clicks > 0"></div>
	<div class="popup" style="top: 15%;	left: 23%;" ng-if="clicks === 1">
		<div class="arrow">
			<i class="fa fa-play"></i>
		</div>
		I am the Stig
		<br>
		<a ng-click="skip()">Skip</a>
		<a ng-click="triggerStepCount()">Next</a>
	</div>

	<div class="popup" style="top: 15%;	left: 75%;" ng-if="clicks === 2">
		<div class="arrow">
			<i class="fa fa-play"></i>
		</div>
		Some say that I am made of horses.
		<br>
		<a ng-click="skip()"> Skip </a>
		<a ng-click="triggerBackCount()">Back</a>
		<a ng-click="triggerStepCount()">Next</a>
	</div>
</div>
{% endblock %}
